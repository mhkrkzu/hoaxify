import React, {useState} from 'react';import ProfileImageWithDefault from "./ProfileImageWithDefault";import {Link} from "react-router-dom";import {format} from "timeago.js";import {useTranslation} from "react-i18next";import {useSelector} from "react-redux";import Modal from "./Modal";import {deleteHoax} from "../api/apiCalls";import {useApiProgress} from "../shared/ApiProgress";const HoaxView = (props) => {    const loggedInUser = useSelector(store => store.username)    const {hoax, onDeleteHoax} = props;    const {user, content, createdTimestamp, fileAttachment, id} = hoax;    const {username, displayName, image} = user;    const [modalVisible, setModalVisible] = useState(false)    const pendingApiCall = useApiProgress('delete', `/api/1.0/hoaxes/${id}`, true);    const {i18n, t} = useTranslation();    const onClickDelete = async () => {        await deleteHoax(id)        onDeleteHoax(id);    }    const onClickCancel = () => {        setModalVisible(false);    }    const formatted = format(createdTimestamp, i18n.language);    const ownedByLoggedInUser = loggedInUser === username;    return (        <>            <div className="card p-1">                <div className="d-flex">                    <ProfileImageWithDefault className="rounded-circle m-1" image={image} height="32" width="32"/>                    <div className="flex-fill m-auto pl-2">                        <Link to={`/user/${username}`} className="text-info">                            <h6 className="d-inline">{displayName}@{username}</h6>                            <span className="text-dark"> - </span>                            <span className="text-danger">{formatted}</span>                        </Link>                    </div>                    {ownedByLoggedInUser && (                        <button className="btn btn-sm btn-delete-link" onClick={() => setModalVisible(true)}>                            <i className="material-icons">delete_outline</i>                        </button>                    )}                </div>                <div className="card-body pt-0 pb-2">                    <div className="pl-5">                        {content}                        {fileAttachment && (                            <div className="pt-2">                                {fileAttachment.fileType.startsWith('image') && (                                    <img className="img-fluid" src={'images/attachment/' + fileAttachment.name}                                         alt={content}/>                                )}                                {!fileAttachment.fileType.startsWith('image') && (                                    <strong>Hoax Has Unknown Attachment</strong>                                )}                            </div>                        )}                    </div>                </div>            </div>            <Modal onClickCancel={onClickCancel}                   onClickOk={onClickDelete}                   title={t('Delete Hoax')}                   okButton={t('Delete Hoax')}                   pendingApiCall={pendingApiCall}                   visible={modalVisible} message={                <div>                    <div>                        <strong>{t('Are you sure to delete hoax?')}</strong>                    </div>                    <span>{content}</span>                </div>            }/>        </>    );};export default HoaxView;